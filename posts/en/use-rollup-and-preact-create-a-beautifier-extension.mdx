---
title: "Developing a Large Page Beautification Plugin with Rollup + Preact"
tag: Coding
createAt: 2023/2/5
---

Recently, the final grades were released (probably sent by mail), and I found the school's academic system to be really ugly. I decided to write a browser plugin to beautify it.

Upon opening the academic system, a wave of retro skeuomorphic style from the 2000s hit me. Countless `tr` and `td` elements formed a table layout, variable names were whimsically named in Pinyin, and global functions were set up haphazardly... We can probably guess that the working environment for programmers at that time was not very good.

![](https://cdn.jsdelivr.net/gh/filess/img3@main/2023/01/19/1674135191542-5a8b7b7f-036d-42a5-9cb0-3edb05d9f880.png)

## Prerequisites

## Setting Up the Scaffold

To reduce the size of the plugin, we chose the excellent React alternative, Preact, to develop the user interface.

Install a series of dependencies:

```bash
yarn add preact

yarn add -D @rollup/plugin-node-resolve @rollup/plugin-commonjs @rollup/plugin-typescript @rollup/plugin-babel

yarn add -D @babel/core @rollup/plugin-alias @babel/plugin-transform-react-jsx
```

Write the Rollup configuration.

```js
import { nodeResolve } from "@rollup/plugin-node-resolve";
import commonjs from "@rollup/plugin-commonjs";
import typescript from "@rollup/plugin-typescript";
import { babel } from "@rollup/plugin-babel";

const extensions = [".js", ".jsx", ".ts", ".tsx"];

export default [
	{
		input: "src/components/content.js",
		output: [
			{
				file: "dist/content.bundle.cjs.js",
				format: "cjs",
				sourcemap: true,
			},
			{
				file: "dist/content.bundle.esm.js",
				format: "esm",
				sourcemap: true,
			},
		],
		plugins: [
			nodeResolve({ extensions }),
			commonjs(),
			babel({
				babelHelpers: "bundled",
				extensions,
				include: ["src/**/*"],
			}),
		],
	},
];
```

![](https://cdn.jsdelivr.net/gh/filess/img3@main/2023/01/18/1674014555394-c7bdfd44-7991-462f-8f57-ed2cfa157369.png)

## Analyzing the Page

